&НаКлиенте
Процедура ЗагрузитьФайлНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	
	ДиалогВыбораФайла = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
	ДиалогВыбораФайла.Фильтр                      = НСтр("ru='CSV файл (*.csv)|*.csv'");
	ДиалогВыбораФайла.Заголовок                   = НСтр("ru='Выберите CSV файл'");
	ДиалогВыбораФайла.ПредварительныйПросмотр     = Ложь;
	ДиалогВыбораФайла.Расширение                  = "csv";
	ДиалогВыбораФайла.ИндексФильтра               = 0;
	ДиалогВыбораФайла.ПолноеИмяФайла              = ВыбиретеФайл;
	ДиалогВыбораФайла.ПроверятьСуществованиеФайла = Ложь;
	
	Если ДиалогВыбораФайла.Выбрать() Тогда
		ВыбиретеФайл = ДиалогВыбораФайла.ПолноеИмяФайла;
	КонецЕсли;
		
КонецПроцедуры


&НаСервере
Процедура ЗагрузитьНаСервере()
		
	Док = Новый ТекстовыйДокумент();
	Док.Прочитать(ВыбиретеФайл);
	
	Для i=2 По Док.КоличествоСтрок() Цикл	
		КонстантаСтрока = Док.ПолучитьСтроку(i);
		Массив = СтрРазделить(КонстантаСтрока, ";");
		Наименование = Массив[0];
		ВидНоменклатуры = Массив[1];			
		Группа = Массив[2];
		ЦенаПоступления = Массив[3];
		СтавкиНДС =  Массив[4];
		Склад = Массив[5];
		Магазин = Массив[6];
		НоваяНоменклатура = Справочники.Номенклатура.СоздатьЭлемент();
		НоваяНоменклатура.Родитель = Справочники.Номенклатура.НайтиПоНаименованию(Группа);
		НоваяНоменклатура.Наименование = Наименование;
		НоваяНоменклатура.СтавкиНДС = СтавкиНДС;
		НоваяНоменклатура.ЦенаПоступления = ЦенаПоступления;
		НоваяНоменклатура.Склад = Склад;
		НоваяНоменклатура.Магазин = Магазин;
		
		Если ВидНоменклатуры = "Товар" Тогда
			
			НоваяНоменклатура.ВидНоменклатуры = Перечисления.ВидыНоменклатуры.Товар;
		Иначе
			НоваяНоменклатура.ВидНоменклатуры = Перечисления.ВидыНоменклатуры.Услуга;
			
		КонецЕсли; 
		
		Если НоваяНоменклатура.Склад = Справочники.Склады.ПустаяСсылка()Тогда	
			
			НоваяНоменклатура.Склад = Константы.СкладПоУмолчанию.Получить();
			
		КонецЕсли;
		
		Если ВидНоменклатуры = "Услуга" И НоваяНоменклатура.Магазин = Справочники.Магазин.ПустаяСсылка()Тогда	
			
			НоваяНоменклатура.Магазин = Константы.СкладПоУмолчанию.Получить();
			
		КонецЕсли;
		
		Номенклатура =  НоваяНоменклатура.СтавкиНДС;
		
		Если НоваяНоменклатура.СтавкиНДС = Справочники.СтавкиНДС.ПустаяСсылка()Тогда	
			
			НоваяНоменклатура.СтавкиНДС = Константы.СтавкаНДСПоУмолчанию.Получить();
			
		КонецЕсли;
		
		Попытка
			НоваяНоменклатура.Записать();
		Исключение
			Сообщить(ОписаниеОшибки());
		КонецПопытки;
		
	КонецЦикла;
	
	Сообщить("Новые позиций в справочник Номенклатура загружены", СтатусСообщения.Информация);
	
КонецПроцедуры

&НаКлиенте
Процедура Загрузить(Команда)
	
	ЗагрузитьНаСервере();
	
КонецПроцедуры
